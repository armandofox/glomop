head	1.34;
access;
symbols
	Yatin-final:1.31
	Yatin:1.31.0.2
	pre-yatin-merge:1.31
	transend-beta2:1.19
	fox-dev:1.19.4.4
	transend-ng:1.4
	transend-beta-latest:1.4
	Aggregators:1.4
	NoAggregators:1.3
	iang:1.3.0.2
	transend-beta:1.2.0.2;
locks; strict;
comment	@# @;


1.34
date	98.07.11.00.40.28;	author fox;	state Exp;
branches;
next	1.33;

1.33
date	98.02.12.01.32.27;	author fox;	state Exp;
branches;
next	1.32;

1.32
date	98.01.24.22.51.08;	author fox;	state Exp;
branches;
next	1.31;

1.31
date	97.10.26.03.24.58;	author fox;	state Exp;
branches;
next	1.30;

1.30
date	97.10.26.00.34.33;	author fox;	state Exp;
branches;
next	1.29;

1.29
date	97.10.24.19.52.27;	author fox;	state Exp;
branches;
next	1.28;

1.28
date	97.10.18.00.57.29;	author fox;	state Exp;
branches;
next	1.27;

1.27
date	97.10.02.01.17.58;	author fox;	state Exp;
branches;
next	1.26;

1.26
date	97.09.26.03.04.08;	author fox;	state Exp;
branches;
next	1.25;

1.25
date	97.09.26.01.43.49;	author fox;	state Exp;
branches;
next	1.24;

1.24
date	97.09.24.02.05.25;	author fox;	state Exp;
branches;
next	1.23;

1.23
date	97.09.24.00.14.33;	author fox;	state Exp;
branches;
next	1.22;

1.22
date	97.09.12.03.13.46;	author fox;	state Exp;
branches;
next	1.21;

1.21
date	97.09.06.01.08.47;	author fox;	state Exp;
branches;
next	1.20;

1.20
date	97.08.30.21.33.51;	author fox;	state Exp;
branches;
next	1.19;

1.19
date	97.07.30.02.28.14;	author fox;	state Exp;
branches
	1.19.4.1;
next	1.18;

1.18
date	97.07.29.00.31.57;	author fox;	state Exp;
branches;
next	1.17;

1.17
date	97.07.26.00.29.38;	author fox;	state Exp;
branches;
next	1.16;

1.16
date	97.07.25.03.37.35;	author fox;	state Exp;
branches;
next	1.15;

1.15
date	97.07.25.01.06.28;	author fox;	state Exp;
branches;
next	1.14;

1.14
date	97.07.24.03.18.55;	author fox;	state Exp;
branches;
next	1.13;

1.13
date	97.07.22.02.15.40;	author fox;	state Exp;
branches;
next	1.12;

1.12
date	97.07.21.17.15.24;	author fox;	state Exp;
branches;
next	1.11;

1.11
date	97.07.16.08.15.28;	author fox;	state Exp;
branches;
next	1.10;

1.10
date	97.07.15.02.43.01;	author fox;	state Exp;
branches;
next	1.9;

1.9
date	97.07.11.22.15.01;	author fox;	state Exp;
branches;
next	1.8;

1.8
date	97.06.23.04.05.56;	author fox;	state Exp;
branches;
next	1.7;

1.7
date	97.06.19.00.26.56;	author fox;	state Exp;
branches;
next	1.6;

1.6
date	97.06.12.18.31.29;	author fox;	state Exp;
branches;
next	1.5;

1.5
date	97.06.06.00.07.37;	author fox;	state Exp;
branches;
next	1.4;

1.4
date	97.05.21.19.41.00;	author fox;	state Exp;
branches;
next	1.3;

1.3
date	97.04.30.07.55.10;	author fox;	state Exp;
branches;
next	1.2;

1.2
date	97.04.25.01.15.27;	author fox;	state Exp;
branches;
next	1.1;

1.1
date	97.04.18.21.16.47;	author fox;	state Exp;
branches;
next	;

1.19.4.1
date	97.08.11.04.13.38;	author fox;	state Exp;
branches;
next	1.19.4.2;

1.19.4.2
date	97.08.15.07.02.49;	author fox;	state Exp;
branches;
next	1.19.4.3;

1.19.4.3
date	97.08.15.08.16.47;	author fox;	state Exp;
branches;
next	1.19.4.4;

1.19.4.4
date	97.08.16.07.04.13;	author fox;	state Exp;
branches;
next	;


desc
@@


1.34
log
@*** empty log message ***
@
text
@!---------------------------------------------------------------------
!  BEGIN SITE-SPECIFIC CONFIGURATION
!
!  You MUST modify these parameters to create a working installation.
!  You can do this before or after running configure.
!----------------------------------------------------------------------

! Full path to the directory in which you found this file (top level of
!  the distribution)
!
proxy.home:  /home/fox/transend-beta/tcsproxy
!proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
!proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002

! Location of LWP and MD5 Perl modules, if nonstandard.  Only needed
!   if you want to use the Perl-based HTML distiller (and/or write
!   additional Perl distillers)  *and* your LWP Perl module doesn't live
!   in a standard place.  See the README for more information.
!

!
!  magic URL names:  these should generally point to the Web server that
!  hosts TranSend's "support pages".
!
frontend.webServerName: http://transend.CS.Berkeley.EDU
!frontend.prefsFormDisplayUrl: http://www.CS.Berkeley.EDU/~fox/tmp/prefs.html
frontend.prefsFormDisplayUrl: http://transend.cs.berkeley.edu/transend/prefs.html
frontend.prefsFormSubmitUrl: http://transend-prefs.cs.berkeley.edu/SetPrefs
frontend.getPrefsUrl: http://www.CS.Berkeley.EDU/GetPrefs.html

frontend.prefsChangeUrlString: http://www.CS.Berkeley.EDU/ChangePrefs
frontend.aggString: http://transend.cs.berkeley.edu
                                    
!
! RExec initialization params
! rexec.rsh: name of the remote shell program; (use /usr/bin/rsh along with a 
!            .rhosts file rather than /usr/kerberos/bin/rsh, unless you can 
!            arrange to have kerberos tickets on all the machines on which the
!            frontend and the PTM could possibly be running) 
!            Leave the rexec.rsh entry blank to disable remote execution
! rexec.hosts: comma separated list of remote hosts
! rexec.rsh: /usr/bin/rsh
!
rexec.rsh:
rexec.args: -n
! rexec.hosts: u42,u43,u44,u45,u46,u47,u48,u49,u50
rexec.hosts:


!--------------------------------
! Cache subsystem configuration
!------------------------------
! A list of hosts running cache nodes; there must be at least 1.
! (port 3128 is assumed, since that's what Harvest uses)

cache.Partition: transend1 transend2 transend3 transend4

!------------------------------------------------------------
!   END SITE SPECIFIC CONFIGURATION
!------------------------------------------------------------

! For cache queries, what is the UDP timeout and # retries?
cache.UDP_timeout_sec: 0
cache.UDP_timeout_usec: 99000
cache.UDP_retries: 3

!------------------------------
!   Distiller configuration
!
! Each line in the distillers database has the following format:
! dist.<distiller-type>: <executable-path> <auto-launch-limit-ms> \
!			<averaging-interval-ms> <distiller args ...> \
!			-- <additional args>
!
! Currently the auto-launch-limit-ms param is the max tolerable queue 
! length. Set it to zero if you want to disable auto-launching.
!
! For both <auto-launch-limit-ms> and <averaging-interval-ms>, you can
! specify - or 0 to use the built-in default value.
!
! <distiller-args> can be any of the command line arguments that the
! distiller can understand. Specifically you can use the -n argument to se
! the notification timeout and -m to set the DistillerMain timeout.
!

!dist.myurl/dispatch: sbin/perl_stub -- perl_dir/miniserver.pl
dist.transend/*/*: sbin/perl_stub -- perl_dir/Dispatcher.pl
!dist.transend/text/html: sbin/perl_stub -- perl_dir/transend.text.html
!dist.transend/text/html: sbin/googoo -- perl_dir/transend.text.html
dist.gifmunger: sbin/giftojpg_munger
!dist.jpgmunger: sbin/jpg_munger
dist.foxcustom: sbin/perl_stub  -- perl_dir/text.html.redify
dist.jpgmunger: sbin/googoo
dist.htmlmunger: sbin/perl_stub -- perl_dir/transend.text.html

dist.wingman/text/*: sbin/perl_stub --  perl_dir/transend.text.piml
dist.wingman/image/*: sbin/perl_stub --  perl_dir/transend.text.piml
!------------------------------

dist.BayAreaCulture.agg: sbin/perl_stub 5 3000 500 perl_dir/BayAreaCulture.agg
dist.metasearch: sbin/perl_stub 5 3000 500 perl_dir/metasearch

!------------------------------
!  PTM configuration
!------------------------------
! location of the PTM executable
!
ptm.executable: sbin/ptm

!
! PTM beaconing channel: <multicast-ip-addr>/<port>[/<ttl>]
!
ptm.multicast: 224.9.9.11/9977/4
ptm.beacon_ms: 1000
ptm.lost_beacons: 3

!------------------------------ 
! Front end configuration
!------------------------------ 
! port to listen on
!
frontend.http_listen_port: 3339
frontend.wing_listen_port: 3338
!
! User prefs gdbm database
!
frontend.userprefs: uprefs.gdbm
!
! Number of worker threads
!
frontend.nthreads: 30
!
! Amount by which to boost priority of accept()'ing thread
!
frontend.acceptPrio: 30


!------------------------------
!  GUI Monitor configuration
!------------------------------
!
! Monitor listening channel: <ip-addr>/<port>[/<ttl>]
! <ip-addr> may be a multicast IP, a unicast IP, or a (unicast) hostname
!
Monitor.listen: 228.8.8.11/9977
!
!  Monitor X resources
!
!  The toplevel frame (containing the "Show" and "Kill" buttons and the
!  label displaying the unit's name) is called Top.
! *Top.show.background:
*Top.label.background: white
*Top.label.width: 25
*Top.host.background: white
*Top.host.width: 25
*Top.kill.foreground: red
*Top.rsh: rsh
!
! destroyondeath: yes => the toplevel window for the unit will be destroyed 
! when a death packet is received
!
*Top.destroyondeath: no
!
! noicons: yes => hiding a toplevel will iconify it
!          no  => hiding a toplevel will withdraw it
!
*Top.noicons: yes
@


1.33
log
@modified distiller error messages to begin with HTTP-like 3-digit numeric status; made distBadInput be an informational rather than error message
@
text
@d86 2
a87 2
dist.myurl/dispatch: sbin/perl_stub -- perl_dir/miniserver.pl
!dist.transend/*/*: sbin/perl_stub -- perl_dir/Dispatcher.pl
d89 1
a89 1
dist.transend/text/html: sbin/googoo -- perl_dir/transend.text.html
d92 1
@


1.32
log
@Moved all browser/ files to wwwroot/ subdirs.  Added miniserver.pl to
eliminate need for separate webserver; notes about it are attached.
2 fixes to dispatch.c logic:
- for server-like dispatch, correct headers are now generated when the
server-mode worker attempts to do a redispatch. (previously, for this
case, the returned headers would be the headers of the original
*request*, not theserver response headers.)
- special-casing for the Prefs form URL was eliminated because it
interferes with the miniserver worker. (Ambiguity arises if a request
both matches the Prefs URL *and* matches the server-mode worker, and
it's ugly to have the miniserver worker special case this.)  Instead,
the miniserver.pl worker does  a redispatch to transend/text/html for
HTML documents, which should catch this case.  this is probably not the
Right Thing long term.

there is a new worker, miniserver.pl, which acts as a very simple
httpd.  the root of its filesystem is {proxy.home}/wwwroot.  note that
it doesn't currently handle cgi's or server-side includes or anything --
all it can do is serve simple static files.

i have made the following changes:

- new submodule tcsproxy/wwwroot, to hold the "support files" for TACC
  apps including transend and wingman.

- moved the existing support files for transend and wingman, including
  the java_gui stuff, from
  tcsproxy/browser to tcsproxy/wwwroot/transend, tcsproxy/wwwroot/wingman,
  and tcsproxy/wwwroot/java_gui, respectively.  tcsproxy/browser is now empty,
  and i will eventually prune it from the tree.

- updated the paths in the html munger transend.text.html to match the
  new structure.

- new perl_dir application miniserver.pl, and new toplevel file
  mime.types (used to map file suffixes to MIME types).  the application
  does in-memory caching and uses stat() to deduce when files need to be
  reloaded, so for local-disk files it shouldn't be too heavy of a
  load.  that the expectation is  that traffic to the wwwroot directory
   will be modest - this worker would suck for running a high-traffic
  server, since it doesn't bound the size of the in-memory cache or attempt
  to manage memory to keep "hot" items nearby as Harvest does.


the easiest way to make this mechanism work:

- add an entry to your options file:

        dist.myurl/dispatch: sbin/perl_stub -- perl_dir/miniserver.pl

- set frontend.aggString to the prefix of URL's that should be served
  from the "fake" web server.

- be sure frontend.webServerName matches frontend.aggString.  (this is
  necessary because frontend.webServerName is used by workers that want
  to access the "support files".  keeping these two properties separate
  leaves the option of running a separate web server if desired.)

- *** IMPORTANT *** because miniserver doesn't handle forms submission
   in any way, the frontend.prefsFormSubmitURL property must be
   constructed so that it DOES NOT MATCH anything that might be
   requested of miniserver.  this isn't so bad when you remember that
   the prefsFormSubmitUrl can be a totally imaginary server.
   UNFORTUNATELY, the file wwwroot/transend/prefs.html, which is the
   prefs-submission form, has to have some name wired into it; i picked
   "http://transend-prefs.cs.berkeley.edu", so that's what the config
   files will need to say for now.  i know this is kind of hacky.

-  note that for text/html files, miniserver.pl will redispatch to
   transend/text/html; for other files it will do nothing, ie just
   return the file.  i'm not sure this is the right thing all the time,
   though it's certainly right for transend (causes user prefs form to
   be filled in with existing prefs values).
@
text
@d88 2
a89 1
dist.transend/text/html: sbin/perl_stub -- perl_dir/transend.text.html
d91 2
a92 1
dist.jpgmunger: sbin/jpg_munger
d161 1
a161 1
*Top.destroyondeath: yes
@


1.31
log
@*** empty log message ***
@
text
@d11 3
a13 3
!proxy.home:  /home/fox/transend-beta/tcsproxy
proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002
d26 3
a28 2
frontend.prefsFormDisplayUrl: http://www.CS.Berkeley.EDU/~fox/tmp/prefs.html
frontend.prefsFormSubmitUrl: http://www.CS.Berkeley.EDU/SetPrefs
d32 1
a32 1
frontend.aggString: http://www.CS.Berkeley.EDU/agg/
d86 3
a88 1
dist.transend/*/*: sbin/perl_stub -- perl_dir/Dispatcher.pl
d128 1
a128 1
frontend.nthreads: 2
@


1.30
log
@config_tr.h.in now conditionally includes a prototype for snprintf()
@
text
@d85 4
a88 9
dist.transend/text/html: sbin/perl_stub -- perl_dir/Dispatcher.pl
dist.kwhilite: sbin/perl_stub -- perl_dir/kwhilite.pl.1
dist.kwhilite2: sbin/perl_stub -- perl_dir/kwhilite.pl.4
dist.transend/image/tbmp: sbin/Tbmp_munger -n 750 -m 30000
dist.html_munge:  sbin/perl_stub -- perl_dir/transend.text.html
!dist.transend/text/html: sbin/perl_stub  5 3000 -n 750 -m 30000 -- perl_dir/transend.text.html
dist.transend/text/x-big-html: sbin/html_munger -n 750 -m 30000
dist.transend/image/gif: sbin/giftojpg_munger
dist.transend/image/jpeg: sbin/jpg_munger
@


1.29
log
@*** empty log message ***
@
text
@d11 3
a13 2
proxy.home:  /home/fox/transend-beta/tcsproxy
!proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
a19 1
!proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002
d87 1
d130 1
a130 1
frontend.nthreads: 200
@


1.28
log
@fixed memory leaks in frontend resulting from distiller data and
metadata being cloned but never freed (dispatch.c)
@
text
@d11 2
a12 2
!proxy.home:  /home/fox/transend-beta/tcsproxy
proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
d19 1
a19 1
proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002
d85 2
a86 2
!dist.transend/text/html: sbin/perl_stub -- perl_dir/caller.pl
!dist.fox/test/callee: sbin/perl_stub -- perl_dir/kwhilite.pl.1
d88 1
a88 1
dist.transend/text/html:  sbin/perl_stub -- perl_dir/transend.text.html
d129 1
a129 1
frontend.nthreads: 5
@


1.27
log
@updated documentation both in doc subdir and in pod stuff inside .pm files in xs
@
text
@d11 2
a12 2
proxy.home:  /home/fox/transend-beta/tcsproxy
!proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
d19 1
a19 1
!proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002
d129 1
a129 1
frontend.nthreads: 20
@


1.26
log
@yucko - refinement now works.  someone had put a linein
transend.text.piml that deletes all NUL's from the input, but that's the
wrong thing for non-ascii data such as images.  also minor fix to
perl_stub to cover corner case of null input data or null input
metadata.  the debugging msgs in Tbmp_munger are now just that - not
spewage to stderr.
@
text
@d111 1
a111 1
ptm.multicast: 224.9.9.9/9977/4
d143 1
a143 1
Monitor.listen: 228.8.8.8/9977
@


1.25
log
@inter distiller calling seems to work in context of pilot perl distiller
@
text
@d94 2
a95 2
dist.wingman/*/*: sbin/perl_stub --  perl_dir/transend.text.piml
!dist.wingman/image/*: sbin/perl_stub  - 3000 --  perl_dir/transend.text.piml
@


1.24
log
@calling other distillers now works from perl - still need to check for
mem leaks, weird cases, etc.  added stuff in configure.in to set the
right arguments for runtime lib paths, for both solaris ld and gnu ld.
@
text
@d11 2
a12 2
!proxy.home:  /home/fox/transend-beta/tcsproxy
proxy.home:  /disks/barad-dur/sandbox1/tmp/fox/tcsproxy
d19 1
a19 1
proxy.perlmod: /disks/barad-dur/now/pythia/release/lib/perl-5.002
d85 3
a87 2
dist.transend/text/html: sbin/perl_stub -- perl_dir/caller.pl
dist.fox/test/callee: sbin/perl_stub -- perl_dir/kwhilite.pl.1
d92 1
a92 1
dist.transend/image/jpeg: sbin/jpg_munger 5 3000
d94 2
a95 2
dist.wingman/text/*: sbin/perl_stub --  perl_dir/transend.text.piml
dist.wingman/image/*: sbin/perl_stub  - 3000 --  perl_dir/transend.text.piml
@


1.23
log
@kwhilite* files modified for in-class examples. Distill() functionality
in clib.xs still not quite working - this commit will allow me to move
it to purify.  Added stuff to perl_stub makefile so that libperl.so's
directory is added to runtime dynamic lib path.
@
text
@d11 2
a12 1
proxy.home:  /home/fox/transend-beta/tcsproxy
d19 1
a19 1
proxy.perlmod:
d85 1
a85 1
dist.fox/text/html: sbin/perl_stub -- perl_dir/caller.pl
@


1.22
log
@Optimizations to Pilot distiller:
- 'wx' and 'string_width' optimized, since profiler indicated a lot of
time was being spent there.
- postprocessed images are now cached during processing of the same
page, so addditional instances of an inline image are free.
- Clib_Async_Fetch is now used in the distiller to prefetch images, so
they'll be in the cache when we're ready to distill them.
Also: added 'canonicalize' routine (to TACCutils) for canonicalizing
relative urls, fixed some perl warnings in PilotFonts and SimpleFont.
@
text
@d69 25
a93 2
!       dist.<distiller-type>: <executable-path> <ptm args>  -- <distiller-args>
!  All except distiller-type and executable-path are optional.
a94 9

dist.transend/text/html: sbin/perl_stub  5 3000 500 -- perl_dir/transend.text.html
dist.transend/text/x-big-html: sbin/html_munger
! dist.transend/image/gif: sbin/gif_munger
dist.transend/image/gif: sbin/giftojpg_munger 5 3000 500
dist.transend/image/jpeg: sbin/jpg_munger 5 3000 500
dist.wingman/*/*: sbin/perl_stub  5 3000 500 --  perl_dir/transend.text.piml
                         
dist.fox.text.html: sbin/perl_stub 5 3000 500 perl_dir/fox.text.html
@


1.21
log
@Removed compile time dependencies: proxy.home and proxy.perlmod are now
config file options, so perl_stub doesn't need to know them at compile
time (it constructs the -I path at runtime from the options file
values).  Options_Find() has been exported to Perl (in
clib.xs) and is emulated for the harness (in clib.pm).  pilotFonts
directory was added for wingman distiller.  PilotFonts module now has an
explicit init_fonts() call that supplies the dir name containing the
pilot fonts.  Added documentation to clib.pm, TACCutils.pm,
PilotFonts.pm and SimpleFont.pm.  removed all path-related dependencies
in existing distillers and unpack_tstr.pl, and added font path error
checking to layout.tcl
@
text
@d104 2
a105 1
frontend.listen_port: 3339
@


1.20
log
@reintegrated from branch fox-dev; bug remaining in dispatch.c which should always return a DistillerStatus and not an HTTP_Status
@
text
@d1 2
d4 3
a6 15
! Each line in the distillers database has the following format:
!       <distiller-type>: <executable-path>
!

dist.transend/text/html: sbin/perl_stub  5 3000 500 -- perl_dir/transend.text.html
dist.transend/text/x-big-html: sbin/html_munger
! transend/image/gif: sbin/gif_munger
dist.transend/image/gif: sbin/giftojpg_munger 5 3000 500
dist.transend/image/jpeg: sbin/jpg_munger 5 3000 500
dist.wingman/*/*: sbin/perl_stub  5 3000 500 --  perl_dir/transend.text.piml
                         
dist.fox.text.html: sbin/perl_stub 5 3000 500 perl_dir/fox.text.html

dist.BayAreaCulture.agg: sbin/perl_stub 5 3000 500 perl_dir/BayAreaCulture.agg
dist.metasearch: sbin/perl_stub 5 3000 500 perl_dir/metasearch
d8 2
d11 1
d13 4
a16 10
!------------------------------ 
! Front end configuration
!------------------------------ 
! port to listen on
!
frontend.listen_port: 3339
!
! User prefs gdbm database
!
frontend.userprefs: uprefs.gdbm
d18 1
a18 7
! Number of worker threads
!
frontend.nthreads: 20
!
! Amount by which to boost priority of accept()'ing thread
!
frontend.acceptPrio: 30
d21 2
a22 1
!  magic URL names
d32 16
d51 3
a53 2
! A list of cache partition host names
!cache.Partition: dawn10 dawn11 dawn12 dawn13 dawn14
d56 4
d66 20
d98 15
d114 1
a114 8
! RExec initialization params
! rexec.rsh: name of the remote shell program; (use /usr/bin/rsh along with a 
!            .rhosts file rather than /usr/kerberos/bin/rsh, unless you can 
!            arrange to have kerberos tickets on all the machines that the 
!            frontend and the PTM could possibly be running) 
!            Leave the rexec.rsh entry blank to disable remote execution
! rexec.hosts: comma separated list of remote hosts
! rexec.rsh: /usr/bin/rsh
d116 2
a117 4
rexec.rsh:
rexec.args: -n
! rexec.hosts: u42,u43,u44,u45,u46,u47,u48,u49,u50
rexec.hosts:
@


1.19
log
@Toplevel Makefile slimmed down.  lib/ subdir and corresponding install
targets added, to prep for binary dist.  client_lib now has
strerror()-style error reporting.  Fixed bug in dispatch.c that caused
prefs call for an aggregator to coredump (strcpy called on null ptr).
text/html distiller more streamlined and correctly "munges" user prefs
form items.  GetOptions moved from clib to TaccUtils.  perl_stub now
passes arguments named "s11", "i2", etc. instead of "11", "2", etc.
@
text
@a5 1
!dist.transend/text/html: sbin/html_munger 5 3000 500
d7 6
a17 4
! transend/image/gif: sbin/gif_munger
dist.transend/image/gif: sbin/giftojpg_munger 5 3000 500
dist.transend/image/jpeg: sbin/jpg_munger 5 3000 500
dist.wingman/*/*: sbin/perl_stub  5 3000 500 --  perl_dir/transend.text.piml
d33 1
a33 1
frontend.nthreads: 300
d55 1
a55 2
cache.Partition: dawn11
!cache.Partition: transend1
@


1.19.4.1
log
@armandos development version for rebuilding the frontend - do not use
@
text
@d6 1
a7 6
dist.transend/text/x-big-html: sbin/html_munger
! transend/image/gif: sbin/gif_munger
dist.transend/image/gif: sbin/giftojpg_munger 5 3000 500
dist.transend/image/jpeg: sbin/jpg_munger 5 3000 500
dist.wingman/*/*: sbin/perl_stub  5 3000 500 --  perl_dir/transend.text.piml
                         
d13 4
@


1.19.4.2
log
@*** empty log message ***
@
text
@d55 2
a56 1
cache.Partition: transend1
@


1.19.4.3
log
@*** empty log message ***
@
text
@d55 1
a55 1
cache.Partition: transend1.cs.berkeley.edu
@


1.19.4.4
log
@a huge amount of frontend reengineering, plus added a Clone() method to
the DistillerBuffer.  basic operation of frontend seems stable.
things that haven't been tested yet:
- POST
- cache cut through behavior
- client timeout doesn't seem to work (never times out??)
- redispatch and similar support for aggregators
and some things still to be implemented:
- support for listening/dispatching on multiple ports
- documentation of what all the files do (and rename the http-specific
sourcefiles)
- eliminate redundant .h inclusions from various sourcefiles
- 'makedepend' for the Makefile.in
@
text
@d33 1
a33 1
frontend.nthreads: 5
d55 1
a55 1
cache.Partition: transend1 transend2 transend3 transend4
@


1.18
log
@fixed TACCutils bug that sometimes caused next_entity to enter infinite
loop.  beginning frontend cleanup to separate service-specific stuff
from core stuff.  ifdef'd out the instrumentation code in
httpsupport.c:parse_status_and_headers, which was likely causing
segfaults.  removed sbrk() monitoring from thr_mon.c because it was
bogus.  tested the Bypass feature for big pages (it works) and set
bypass threshold to about 1.5MB in clib.h.  monitor window is now
resizable though not all the fields resize intelligently.
@
text
@d7 2
a8 2
dist.transend/text/html: sbin/perl_stub  5 3000 500 perl_dir/transend.text.html
dist.fox/text/html: sbin/perl_stub 5 3000 500
d54 2
a55 2
!cache.Partition: dawn11
cache.Partition: transend1
a72 5

! Distiller auto-launch database location
!
distiller.db: distillers.db.fox

@


1.17
log
@makefile fixes to have lib/ subdir now work on both.  anonymization added to frontend.  still a lurking stack-stomping bug in httpsupport.c
@
text
@d32 1
a32 1
frontend.nthreads: 30
d72 1
a72 1
ptm.multicast: 224.9.9.9/9988/4
d102 1
a102 1
Monitor.listen: 228.8.8.8/8879
@


1.16
log
@evil bug in parse_status_and_headers was overwriting caller stack and
causing coredumps....we flushed it out of hiding by forcing everything
to bypass.  still need to test steve's changes and retrofit the new
mechanism for dealing with push.jpg.
@
text
@d16 1
a16 2
dist.wingman/text/html: sbin/perl_stub  5 3000 500 --  perl_dir/transend.text.piml
dist.wingman/text/plain: sbin/perl_stub 5 3000 500 perl_dir/transend.text.piml
@


1.15
log
@temporary commit so anthony can make; still tracking memory bug interaction frontend/clientlib
@
text
@d25 1
a25 1
frontend.listen_port: 3333
d33 1
a33 1
frontend.nthreads: 10
@


1.14
log
@Changed the enum in clib.h to a series of #defines, so that the perl
extension builder automatically makes the values available to perl.
Much work on the perl html munger (using the new lexer): <img> attribute
GMMAGIC is now converted to URL magic in the SRC attribute by the
munger.  MonitorClient_Send and GetOptions are now available to perl
distillers; this required changes to perl_stub and clib.xs.  Bug fix to
tag_from_attribs routine in TACCutils.pm.  Tcl/tk simulator now supports
"reload" and "open", and canvas is resized correctly.  Perl harness now
turns on  perl -w by default.
@
text
@d42 1
a42 1
frontend.webServerName: transend.CS.Berkeley.EDU
@


1.13
log
@fixed makefile bugs to compile under both linux and solaris
@
text
@d6 2
a7 1
dist.transend/text/html: sbin/html_munger 5 3000 500
d10 2
a11 2
dist.BayAreaCulture.agg: sbin/perl_stub 5 3000 500
dist.metasearch: sbin/perl_stub 5 3000 500
a12 1
!dist.transend/text/html: sbin/perl_stub  5 3000 500 perl_dir/transend.text.html
d16 1
a16 1
dist.wingman/text/html: sbin/perl_stub  5 3000 500 -- -I/home/fox/tcsproxy/xs/lib perl_dir/transend.text.piml
d42 1
a42 1
frontend.webServerName: www.CS.Berkeley.EDU
@


1.12
log
@minor changes to make monitor unicast-capable and allow compilation on other linuxes (need explicit link to libgcc?)
@
text
@d6 2
a7 2
transend/text/html: bin/html_munger
dist.fox/text/html: sbin/perl_stub
d9 2
a10 2
dist.BayAreaCulture.agg: sbin/perl_stub
dist.metasearch: sbin/perl_stub
d14 3
a16 3
dist.transend/image/gif: sbin/giftojpg_munger
dist.transend/image/jpeg: sbin/jpg_munger
dist.wingman/text/html: sbin/perl_stub  5 3000 500 perl_dir/transend.text.piml
d42 3
a44 2
frontend.serverName: www.CS.Berkeley.EDU
frontend.setPrefsUrl: http://www.CS.Berkeley.EDU/~fox/tmp/prefs.html
d46 1
a47 1
frontend.prefsSetUrlString: http://www.CS.Berkeley.EDU/SetPrefs
d100 2
a101 1
! Monitor listening channel: <multicast-ip-addr>/<port>[/<ttl>]
d103 1
a103 1
Monitor.listen: 127.0.0.0/7777
@


1.11
log
@makefile changes to get everything to compile with 2 different versions of pthreads, and with tcl/tk that does not already link the gcc library.
@
text
@d101 1
a101 1
Monitor.listen: 228.8.8.8/8881/4
@


1.10
log
@makefile changes to link pthreads only at end, which was causing severe bad behaviors under linux since different people were calling different signal()s.  SIGHUP is now used instead of SIGUSR1 to signal components to reinitialize themselves, and SIGTERM is used to kill them gracefully.  Layout stuff for Pilot works but is still inelegant.
@
text
@d6 1
a6 1
! transend/text/html: bin/html_munger
@


1.9
log
@*** empty log message ***
@
text
@d12 1
a12 1
dist.transend/text/html: sbin/perl_stub  5 3000 500 perl_dir/transend.text.html
d17 1
d54 2
a55 1
cache.Partition: dawn11
@


1.8
log
@*** empty log message ***
@
text
@d12 1
a12 1
dist.transend/text/html: sbin/perl_stub perl_dir/transend.text.html
d16 1
d24 1
a24 1
frontend.listen_port: 4444
d76 1
a76 1
ptm.beacon_ms: 8000
@


1.7
log
@changes and additions to transend.text.piml (pilot markup language html
distiller).  commented the ARGS.h file for distillers.  distillers now
only observe Quality arg if it has a reasonable value.  Changes to main
prefs to make values of FRONT_SHOW_ICON arg agree with perl html distiller.
@
text
@d7 1
a7 1
fox/text/html: sbin/perl_stub
d12 1
a12 1
dist.transend/text/html: sbin/perl_stub
@


1.6
log
@various changes to makefiles to support auto-installation into sbin and bin directories.  perl HTML distiller no longer inserts UI in pages with frames.  PREFS_URL and similar strings are now static char* instead of #defines, but still need them to be initialized in PTM stub so distillers can get at them.  "run" targets are better now, they run stuff from the sbin and bin directories.
@
text
@d7 1
a7 1
fox/text/html: perl_stub/perl_stub
d9 2
a10 2
BayAreaCulture.agg: perl_stub/perl_stub
metasearch: perl_stub/perl_stub
d12 4
a15 4
transend/text/html: sbin/perl_stub
! transend/image/gif: bin/gif_munger
transend/image/gif: bin/giftojpg_munger
transend/image/jpeg: bin/jpg_munger
@


1.5
log
@Many changes to support SDK, including bin and sbin directories,
and modified make targets and names of some binary targets.  Calling
convention changed for perl distillers, so fixed html distiller and
added it as transend.text.html.  monitor.multicast property is now
Monitor.listen; all relevant code was changed.  Monitor can now parse
this from the options file.  Updated all UI changes from branch head.
@
text
@d1 17
d37 10
d64 1
a64 1
ptm.executable: ../ptm/ptm
d73 1
a73 1
distiller.db: ptm/distillers.db.fox
d75 1
a75 1
ptm.beacon_ms: 5000
@


1.4
log
@Changes, including some HACKS in dispatch.c, to support aggregator behavior.  New doc file explaining how to write them, but its out of date.  sample aggregators and new stuff in TACCutils.pm.  different syntax for specifying distillers/aggregators.
@
text
@d46 1
a46 1
distiller.db: ../ptm/distillers.db.fox
d62 2
a63 1
rexec.hosts: u42,u43,u44,u45,u46,u47,u48,u49,u50
d71 1
a71 1
monitor.multicast: 228.8.8.8/8881/4
@


1.3
log
@frontend and ptm changes for new distiller api
@
text
@d6 1
a6 1
frontend.listen_port: 4445
d14 1
a14 1
frontend.nthreads: 36
d24 2
a25 6
cache.Partition: dawn10 dawn11 dawn12 dawn13 dawn14

! IP address, port, and TTL for monitor
cache.Monitor_ip: 228.7.7.8
cache.Monitor_port: 8881
cache.Monitor_ttl: 4
@


1.2
log
@*** empty log message ***
@
text
@d6 1
a6 1
frontend.listen_port: 4444
d28 1
a28 1
cache.Monitor_port: 8884
d46 1
a46 1
ptm.multicast: 224.9.9.9/9995/4
d74 1
a74 1
monitor.multicast: 228.8.8.8/8885/4
@


1.1
log
@*** empty log message ***
@
text
@d23 12
a34 4
! [Steve: insert cache configuration stuff here from part.config, and
!   modify Clib_Initialize to take an Options as its first arg instead
!   of a filename]
!
@
